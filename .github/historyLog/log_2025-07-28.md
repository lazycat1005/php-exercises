# 開發紀錄 2025-07-28

## 修改項目

### [modify] 08 溫度轉換 AJAX 版本修復

1. **修改 `app/Helper/htmlHelper.php`**：

   - 在 `renderFooter` 方法中新增共用 `common.js` 檔案的載入
   - 確保每個練習題頁面都會載入 `common.js` 和專用 JS 檔案

2. **修改 `exercises/08_temperature-unit-conversion/version-ajax/index.php`**：
   - 將 `<?= ?>` 簡寫語法改為完整的 `<?php echo ?>` 語法，符合專案規範
   - 將輸入欄位從 `type="number"` 改為 `type="text"`，避免與自訂驗證衝突
   - 修改錯誤訊息顯示區域結構，從 `<p class="messageText">` 改為 `<div class="messageText"><p></p></div>`

## 問題原因分析

溫度轉換程式無法正常運作的主要原因：

1. JavaScript 的 AJAX 版本檢測邏輯依賴 `.messageText p` 元素，但 HTML 結構不匹配
2. `renderFooter` 方法未載入共用的 `common.js` 檔案
3. `input type="number"` 與自訂的數值驗證邏輯產生衝突

## 測試建議

修改完成後建議測試：

1. 輸入數值是否能正常轉換
2. 輸入非數值是否顯示正確錯誤訊息
3. 輸入科學記號格式是否被正確阻擋
4. 清空輸入框時另一欄位是否被啟用

---

### [modify] 重構 08temperature.js 檔案結構

- **背景**：原本的 `08temperature.js` 使用條件判斷來處理兩個不同版本（AJAX 和 PHP），導致程式碼複雜且難以維護
- **改進**：將單一檔案拆分為兩個專門的 JavaScript 檔案
  - `08temperatureAjax.js` - 專門處理 AJAX 版本的邏輯
  - `08temperaturePhp.js` - 專門處理 PHP 版本的邏輯
- **檔案異動**：
  - 新增：`/assets/js/08temperatureAjax.js`
  - 新增：`/assets/js/08temperaturePhp.js`
  - 修改：`/exercises/08_temperature-unit-conversion/version-ajax/index.php` - 更新 JS 引用
  - 修改：`/exercises/08_temperature-unit-conversion/version-php/index.php` - 更新 JS 引用
  - 修改：`/assets/js/08temperature.js` - 標記為已棄用並添加註釋
- **優點**：
  - 提高程式碼可讀性和維護性
  - 每個版本的邏輯更加清晰

---

### [add] 08 溫度轉換 PHP 版本清除按鈕功能

- **修改檔案**：`/assets/js/08temperaturePhp.js`
- **新增功能**：為清除按鈕添加 PRG（Post-Redirect-Get）模式的清除功能
- **實作方式**：點擊清除按鈕時，使用 `window.location.href = window.location.pathname` 重新導向到不帶任何 GET 參數的頁面
- **效果**：使用者點擊清除按鈕後，頁面會回到初始狀態，清除所有輸入資料和結果顯示
  - 減少不必要的條件判斷
  - 符合單一職責原則

#### 技術細節

- **AJAX 版本特點**：
  - 使用 `#celsius`, `#fahrenheit` ID 選擇器
  - 即時 AJAX 請求進行溫度轉換
  - 自動禁用非活躍輸入框
- **PHP 版本特點**：
  - 使用 `name` 屬性選擇器
  - 支援 Enter 鍵快速提交
  - 清除按鈕功能
